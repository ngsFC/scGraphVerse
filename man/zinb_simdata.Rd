% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/zinb_simdata.R
\name{zinb_simdata}
\alias{zinb_simdata}
\title{Simulate Multiple Zero-Inflated Negative Binomial (ZINB) Count Matrices with Cell-Specific Depth}
\usage{
zinb_simdata(
  n,
  p,
  B,
  mu_range,
  mu_noise,
  theta,
  pi,
  kmat = 1,
  depth_range = NA,
  seed = NULL
)
}
\arguments{
\item{n}{Integer. The number of samples (cells) in each simulated matrix.}

\item{p}{Integer. The number of variables (genes) in each matrix.}

\item{B}{Matrix. A \strong{symmetric binary adjacency matrix} (\code{0/1}), where rows and columns correspond
to gene names. The adjacency matrix defines gene-gene connectivity, influencing expression levels.}

\item{mu_range}{List of numeric vectors. Each element is a numeric vector of length 2, specifying
the range of mean expression (\code{mu}) values per matrix. The function draws gene-specific means from
a uniform distribution within these ranges.}

\item{mu_noise}{Numeric vector of length \code{kmat}. Mean of the background noise component for each matrix.}

\item{theta}{Numeric vector of length \code{kmat}. The dispersion parameter of the \strong{negative binomial distribution}
for each matrix. A lower value of \code{theta} increases overdispersion.}

\item{pi}{Numeric vector of length \code{kmat}. The probability of excess zeros (\verb{0 < pi < 1}) for each matrix,
controlling sparsity due to dropouts or biological factors.}

\item{kmat}{Integer. The number of count matrices to generate (default: \code{1}).}

\item{depth_range}{Numeric vector of length 2 or \code{NA}. If provided, defines the range of total sequencing
depth per cell (e.g., \code{c(500, 5000)}). Default: \code{NA} (no depth scaling applied).}

\item{seed}{Integer (optional). A random seed for reproducibility.}
}
\value{
A \strong{list} of \code{kmat} numeric matrices, each with dimensions \verb{n x p}, where:
\itemize{
\item \strong{Rows} correspond to cells (\verb{cell_1, cell_2, ..., cell_n}).
\item \strong{Columns} correspond to genes (from \code{rownames(B)}).
\item Expression values follow a \strong{zero-inflated negative binomial (ZINB)} distribution.
}
}
\description{
This function generates multiple count matrices following a \strong{zero-inflated negative binomial (ZINB)}
distribution using an adjacency matrix that defines gene-gene relationships. Each matrix simulates
gene expression across a specified number of cells, incorporating sequencing depth variability.
}
\details{
The function simulates count data by:
\enumerate{
\item Generating gene expression values from a \strong{zero-inflated negative binomial (ZINB)} model.
\item Modifying gene-gene expression levels based on the adjacency matrix \code{B}.
\item Incorporating \strong{cell-specific sequencing depth} if \code{depth_range} is specified.
}

\strong{Biological Interpretation:}
\itemize{
\item This method is useful for benchmarking \strong{single-cell RNA sequencing (scRNA-seq)} algorithms,
where excess zeros may arise due to \strong{dropout events}.
\item The adjacency matrix \code{B} allows simulation of \strong{gene regulatory network (GRN)} interactions.
\item Sequencing depth variation mimics experimental conditions in \strong{scRNA-seq datasets}.
}
}
\examples{
\dontrun{
# Define adjacency matrix (example with 5 genes)
B <- matrix(0, nrow = 5, ncol = 5)
rownames(B) <- colnames(B) <- paste0("Gene", 1:5)
B[1, 2] <- B[2, 3] <- B[4, 5] <- 1  # Define some gene interactions
B <- B + t(B)  # Make symmetric

# Simulate data with 100 cells, 5 genes, and 2 matrices
zinb_matrices <- zinb_simdata(
  n = 100, p = 5, B = B,
  mu_range = list(c(1, 5), c(2, 6)), mu_noise = c(0.5, 0.7),
  theta = c(1, 2), pi = c(0.2, 0.3), kmat = 2, 
  depth_range = c(500, 5000), seed = 42
)

# View one of the simulated matrices
print(zinb_matrices[[1]])
}
}

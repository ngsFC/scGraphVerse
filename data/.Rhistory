labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
ggtitle("n=100 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_base
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
met_comp_long <- met_comp %>%
pivot_longer(cols = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes")),
p = factor(p, levels = c("82", "217", "554")))
met_comp <- met_data %>%
mutate(Ratio = as.character(Ratio_mean),
p = as.character(p_mean)) %>%
filter(!Predicted_Matrix %in% c("inet", "union")) %>%
mutate(
Predicted_Matrix = ifelse(Predicted_Matrix == "vote", "late", Predicted_Matrix),
Predicted_Matrix = ifelse(Method == "JRF", "joint", Predicted_Matrix)  # Replace JRF with joint
)
met_comp_long <- met_comp %>%
pivot_longer(cols = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_comp_long, aes(x = p, y = Value,
color = Method,
linetype = Predicted_Matrix,  # Change to linetype
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.7, alpha=0.8) +  # Increase line size for better visibility
geom_point(size = 1, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
scale_linetype_manual("Integration", values = c("late"="dashed", "early"="dotted", "joint"="solid")) +  # Custom line types
ggtitle("n=100 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
View()
View(met_comp)
met_comp <- met_data %>%
mutate(Ratio = as.character(Ratio_mean),
p = as.character(p_mean)) %>%
filter(!Predicted_Matrix %in% c("inet", "union")) %>%
mutate(
Predicted_Matrix = ifelse(Predicted_Matrix == "vote", "late", Predicted_Matrix),
Predicted_Matrix = ifelse(Method == "JRF", "joint", Predicted_Matrix)  # Replace JRF with joint
)
met_comp_long <- met_comp %>%
pivot_longer(cols = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_comp_long, aes(x = p, y = Value,
color = Method,
linetype = Predicted_Matrix,  # Change to linetype
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.7, alpha=0.8) +  # Increase line size for better visibility
geom_point(size = 1, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
scale_linetype_manual("Integration", values = c("late"="dashed", "early"="dotted", "joint"="solid")) +  # Custom line types
ggtitle("n=100 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
colnames(v)
colnames(met_comp)
met_comp_long <- met_comp %>%
pivot_longer(cols = c("Modularity_mean", "Communities_mean", "Density_mean", "Transitivity_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("Modularity_mean", "Communities_mean", "Density_mean", "Transitivity_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_comp_long, aes(x = p, y = Value,
color = Method,
linetype = Predicted_Matrix,  # Change to linetype
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.7, alpha=0.8) +  # Increase line size for better visibility
geom_point(size = 1, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
scale_linetype_manual("Integration", values = c("late"="dashed", "early"="dotted", "joint"="solid")) +  # Custom line types
ggtitle("n=100 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
met_comp_long <- met_comp %>%
pivot_longer(cols = c("Modularity_mean", "Density_mean", "Transitivity_mean", "VI_mean", "NMI_mean", "ARI_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("Modularity_mean", "Density_mean", "Transitivity_mean", "VI_mean", "NMI_mean", "ARI_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_comp_long, aes(x = p, y = Value,
color = Method,
linetype = Predicted_Matrix,  # Change to linetype
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.7, alpha=0.8) +  # Increase line size for better visibility
geom_point(size = 1, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
scale_linetype_manual("Integration", values = c("late"="dashed", "early"="dotted", "joint"="solid")) +  # Custom line types
ggtitle("n=100 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
knitr::opts_knit$set(root.dir = "/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results",message=FALSE, warning=FALSE)
library(dplyr)
library(purrr)
library(patchwork)
library(tidyr)
library(ggplot2)
met_files <- c("/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/simp100_10runs.txt",
"/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/simp200_10runs.txt",
"/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/simp500_10runs.txt")
read_and_fulljoin <- function(files) {
df_list <- lapply(files, read.table, header = TRUE, sep = "\t", stringsAsFactors = FALSE)
full_joined_df <- Reduce(function(x, y) full_join(x, y), df_list)
return(full_joined_df)
}
met_data <- read_and_fulljoin(met_files)
met_late <- met_data %>%
mutate(Ratio = as.character(Ratio_mean),
p = as.character(p_mean)) %>%
filter(Predicted_Matrix %in% c("vote", "union", "inet")) %>%
filter(Method != "JRF")
met_late_long <- met_late %>%
pivot_longer(cols = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_late_long, aes(x = p, y = Value,
color = Method,
shape = Predicted_Matrix,
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.4, alpha=0.7) +  # Slightly increase line size and adjust transparency
geom_point(size = 2, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
ggtitle("n=100 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
ggsave("./../analysis/simulation/plot/late_dots_n100.png", plot_final, width = 8, height = 5, dpi = 300, bg = "white")
met_comp <- met_data %>%
mutate(Ratio = as.character(Ratio_mean),
p = as.character(p_mean)) %>%
filter(!Predicted_Matrix %in% c("inet", "union")) %>%
mutate(
Predicted_Matrix = ifelse(Predicted_Matrix == "vote", "late", Predicted_Matrix),
Predicted_Matrix = ifelse(Method == "JRF", "joint", Predicted_Matrix)  # Replace JRF with joint
)
met_comp_long <- met_comp %>%
pivot_longer(cols = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_comp_long, aes(x = p, y = Value,
color = Method,
linetype = Predicted_Matrix,  # Change to linetype
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.7, alpha=0.8) +  # Increase line size for better visibility
geom_point(size = 1, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
scale_linetype_manual("Integration", values = c("late"="dashed", "early"="dotted", "joint"="solid")) +  # Custom line types
ggtitle("n=100 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
ggsave("./../analysis/simulation/plot/metrics_comp.png", plot_final, width = 8, height = 5, dpi = 300, bg = "white")
met_comp_long <- met_comp %>%
pivot_longer(cols = c("Modularity_mean", "Density_mean", "Transitivity_mean", "VI_mean", "NMI_mean", "ARI_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("Modularity_mean", "Density_mean", "Transitivity_mean", "VI_mean", "NMI_mean", "ARI_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_comp_long, aes(x = p, y = Value,
color = Method,
linetype = Predicted_Matrix,  # Change to linetype
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.7, alpha=0.8) +  # Increase line size for better visibility
geom_point(size = 1, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
scale_linetype_manual("Integration", values = c("late"="dashed", "early"="dotted", "joint"="solid")) +  # Custom line types
ggtitle("n=100 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
ggsave("./../analysis/simulation/plot/metrics_graph_comp.png", plot_final, width = 8, height = 5, dpi = 300, bg = "white")
ls
met_files <- c("/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/simp100n500_10runs.txt",
"/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/simp200n500_10runs.txt",
"/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/simp500n500_10runs.txt")
read_and_fulljoin <- function(files) {
df_list <- lapply(files, read.table, header = TRUE, sep = "\t", stringsAsFactors = FALSE)
full_joined_df <- Reduce(function(x, y) full_join(x, y), df_list)
return(full_joined_df)
}
met_data <- read_and_fulljoin(met_files)
met_late <- met_data %>%
mutate(Ratio = as.character(Ratio_mean),
p = as.character(p_mean)) %>%
filter(Predicted_Matrix %in% c("vote", "union", "inet")) %>%
filter(Method != "JRF")
met_late_long <- met_late %>%
pivot_longer(cols = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_late_long, aes(x = p, y = Value,
color = Method,
shape = Predicted_Matrix,
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.4, alpha=0.7) +  # Slightly increase line size and adjust transparency
geom_point(size = 2, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
ggtitle("n=500 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
knitr::opts_knit$set(root.dir = "/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results",message=FALSE, warning=FALSE)
library(dplyr)
library(purrr)
library(patchwork)
library(tidyr)
library(ggplot2)
met_files <- c("/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/simp100_10runs.txt",
"/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/simp200_10runs.txt",
"/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/simp500_10runs.txt")
read_and_fulljoin <- function(files) {
df_list <- lapply(files, read.table, header = TRUE, sep = "\t", stringsAsFactors = FALSE)
full_joined_df <- Reduce(function(x, y) full_join(x, y), df_list)
return(full_joined_df)
}
met_data <- read_and_fulljoin(met_files)
met_late <- met_data %>%
mutate(Ratio = as.character(Ratio_mean),
p = as.character(p_mean)) %>%
filter(Predicted_Matrix %in% c("vote", "union", "inet")) %>%
filter(Method != "JRF")
met_late_long <- met_late %>%
pivot_longer(cols = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_late_long, aes(x = p, y = Value,
color = Method,
shape = Predicted_Matrix,
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.4, alpha=0.7) +  # Slightly increase line size and adjust transparency
geom_point(size = 2, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
ggtitle("n=100 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
ggsave("./../analysis/simulation/plot/late_dots_n100.png", plot_final, width = 8, height = 5, dpi = 300, bg = "white")
met_comp <- met_data %>%
mutate(Ratio = as.character(Ratio_mean),
p = as.character(p_mean)) %>%
filter(!Predicted_Matrix %in% c("inet", "union")) %>%
mutate(
Predicted_Matrix = ifelse(Predicted_Matrix == "vote", "late", Predicted_Matrix),
Predicted_Matrix = ifelse(Method == "JRF", "joint", Predicted_Matrix)  # Replace JRF with joint
)
met_comp_long <- met_comp %>%
pivot_longer(cols = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_comp_long, aes(x = p, y = Value,
color = Method,
linetype = Predicted_Matrix,  # Change to linetype
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.7, alpha=0.8) +  # Increase line size for better visibility
geom_point(size = 1, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
scale_linetype_manual("Integration", values = c("late"="dashed", "early"="dotted", "joint"="solid")) +  # Custom line types
ggtitle("n=100 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
ggsave("./../analysis/simulation/plot/metrics_comp.png", plot_final, width = 8, height = 5, dpi = 300, bg = "white")
met_comp_long <- met_comp %>%
pivot_longer(cols = c("Modularity_mean", "Density_mean", "Transitivity_mean", "VI_mean", "NMI_mean", "ARI_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("Modularity_mean", "Density_mean", "Transitivity_mean", "VI_mean", "NMI_mean", "ARI_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_comp_long, aes(x = p, y = Value,
color = Method,
linetype = Predicted_Matrix,  # Change to linetype
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.7, alpha=0.8) +  # Increase line size for better visibility
geom_point(size = 1, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
scale_linetype_manual("Integration", values = c("late"="dashed", "early"="dotted", "joint"="solid")) +  # Custom line types
ggtitle("n=100 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
ggsave("./../analysis/simulation/plot/metrics_graph_comp.png", plot_final, width = 8, height = 5, dpi = 300, bg = "white")
met_files <- c("/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/simp100n500_10runs.txt",
"/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/simp200n500_10runs.txt",
"/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/simp500n500_10runs.txt")
read_and_fulljoin <- function(files) {
df_list <- lapply(files, read.table, header = TRUE, sep = "\t", stringsAsFactors = FALSE)
full_joined_df <- Reduce(function(x, y) full_join(x, y), df_list)
return(full_joined_df)
}
met_data <- read_and_fulljoin(met_files)
met_late <- met_data %>%
mutate(Ratio = as.character(Ratio_mean),
p = as.character(p_mean)) %>%
filter(Predicted_Matrix %in% c("vote", "union", "inet")) %>%
filter(Method != "JRF")
met_late_long <- met_late %>%
pivot_longer(cols = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_late_long, aes(x = p, y = Value,
color = Method,
shape = Predicted_Matrix,
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.4, alpha=0.7) +  # Slightly increase line size and adjust transparency
geom_point(size = 2, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
ggtitle("n=500 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
ggsave("./../analysis/simulation/plot/late_dots_n500.png", plot_final, width = 8, height = 5, dpi = 300, bg = "white")
met_comp <- met_data %>%
mutate(Ratio = as.character(Ratio_mean),
p = as.character(p_mean)) %>%
filter(!Predicted_Matrix %in% c("inet", "union")) %>%
mutate(
Predicted_Matrix = ifelse(Predicted_Matrix == "vote", "late", Predicted_Matrix),
Predicted_Matrix = ifelse(Method == "JRF", "joint", Predicted_Matrix)  # Replace JRF with joint
)
met_comp_long <- met_comp %>%
pivot_longer(cols = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("TPR_mean", "FPR_mean", "Precision_mean", "F1_mean", "MCC_mean", "Time_in_Minutes_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_comp_long, aes(x = p, y = Value,
color = Method,
linetype = Predicted_Matrix,  # Change to linetype
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.7, alpha=0.8) +  # Increase line size for better visibility
geom_point(size = 1, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
scale_linetype_manual("Integration", values = c("late"="dashed", "early"="dotted", "joint"="solid")) +  # Custom line types
ggtitle("n=500 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
ggsave("./../analysis/simulation/plot/metrics_comp_n500.png", plot_final, width = 8, height = 5, dpi = 300, bg = "white")
met_comp_long <- met_comp %>%
pivot_longer(cols = c("Modularity_mean", "Density_mean", "Transitivity_mean", "VI_mean", "NMI_mean", "ARI_mean"),
names_to = "Metric", values_to = "Value") %>%
mutate(Metric = factor(Metric, levels = c("Modularity_mean", "Density_mean", "Transitivity_mean", "VI_mean", "NMI_mean", "ARI_mean")),
p = factor(p, levels = c("82", "217", "554")))
plot_base <- ggplot(met_comp_long, aes(x = p, y = Value,
color = Method,
linetype = Predicted_Matrix,  # Change to linetype
group = interaction(Method, Predicted_Matrix))) +
geom_line(size = 0.7, alpha=0.8) +  # Increase line size for better visibility
geom_point(size = 1, alpha=0.8) +    # Increase point size for better visibility
labs(x = "Number of Genes (p)", y = "Performance", color = "Method", shape = "Late Strategy") +
theme_minimal() +
scale_color_manual("Methods", values = c("GENIE3"="purple4", "GRNBoost2"="forestgreen", "JRF"="darkorange")) +
scale_linetype_manual("Integration", values = c("late"="dashed", "early"="dotted", "joint"="solid")) +  # Custom line types
ggtitle("n=500 k=3") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
plot_final <- plot_base + facet_wrap(~Metric, scales = "free", ncol = 3)
print(plot_final)
ggsave("./../analysis/simulation/plot/metrics_graph_comp_n500.png", plot_final, width = 8, height = 5, dpi = 300, bg = "white")
library(scGraphVerse)
remove.packages("scGraphVerse")
.rs.restartR()
Sys.setenv(GITHUB_PAT = "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")
devtools::install_github("ngsFC/scGraphVerse", force = T)
library(scGraphVerse)
View()
View(infer_networks())
View(infer_networks)
View(cutoff_adjacency())
View(cutoff_adjacency)
Sys.setenv(GITHUB_PAT = "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")
devtools::install_github("ngsFC/scGraphVerse", force = T)
remove.packages("scGraphVerse")
.rs.restartR()
Sys.setenv(GITHUB_PAT = "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")
devtools::install_github("ngsFC/scGraphVerse", force = T)
setwd("/home/francescoc/Desktop/scGraphVerse/data/")
ddir <- "/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/"
pdir <- "/home/francescoc/Desktop/scGraphVerse/analysis/simulation/plot/"
library(tidyverse)
library(scGraphVerse)
modules <- init_py(python_path ="/usr/bin/python3", required = TRUE)
time <- list()
ddir <- "/home/francescoc/Desktop/scGraphVerse/analysis/simulation/results/"
pdir <- "/home/francescoc/Desktop/scGraphVerse/analysis/simulation/plot/"
adjm <- as.matrix(read.table("./../analysis/simulation/adjacency/adjm_top200_p100.txt"))
colnames(adjm) <- rownames(adjm)
count_matrices <- readRDS("./../analysis/simulation/simdata/sim_n100p100.RDS")
count_matrices <- lapply(count_matrices, t)
seed_base <- 1234
run_id <- 1
time[["GENIE3_late_15Cores"]] <- system.time(
late <- infer_networks(count_matrices,
method="GENIE3",
nCores = 15,
seed=seed_base+run_id)
)
### Symmetrize and ROC
late_wadj <- generate_adjacency(late)
slate_wadj <- symmetrize(late_wadj, weight_function = "mean")
late_auc <- plotROC(slate_wadj, adjm, plot_title = "ROC curve - GENIE3 Late Integration", is_binary = F)
### Cutoff
slate_adj <- cutoff_adjacency(count_matrices = count_matrices,
weighted_adjm_list = slate_wadj,
n = 3,
method = "GENIE3",
nCores = 15)
scores.late.all <- pscores(adjm, slate_adj)
plotg(slate_adj)
early
head(late)
head(slate_adj)
late_auc
count_matrices[[1]]
adjm
slate_wadj
slate_wadj[[1]]
scores.late.all <- pscores(adjm, slate_adj)
slate_adj[[1]]
# GRNBoost2
## Late integration
time[["GRNBoost2_late"]] <- system.time(
late <- infer_networks(count_matrices,
method="GRNBoost2",
grnboost_modules = modules,
seed=seed_base+run_id)
)
late_wadj <- generate_adjacency(late)
slate_wadj <- symmetrize(late_wadj, weight_function = "mean")
slate_adj <- cutoff_adjacency(count_matrices = count_matrices,
weighted_adjm_list = slate_wadj,
n = 3,
method = "GRNBoost2",
grnboost_modules = modules)
slate_adj <- cutoff_adjacency(count_matrices = count_matrices,
weighted_adjm_list = slate_wadj,
n = 3,
method = "GENIE3",
nCores = 15,
debug=T)
remove.packages("scGraphVerse")
.rs.restartR()
Sys.setenv(GITHUB_PAT = "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")
devtools::install_github("ngsFC/scGraphVerse", force = T)
